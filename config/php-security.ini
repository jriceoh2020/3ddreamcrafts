; 3DDreamCrafts PHP Security Configuration
; Place this file in /etc/php/8.2/fpm/conf.d/ or similar directory

; Security Settings
expose_php = Off
allow_url_fopen = Off
allow_url_include = Off
display_errors = Off
display_startup_errors = Off
log_errors = On
error_log = /var/log/php/error.log

; Session Security
session.cookie_httponly = 1
session.cookie_secure = 1
session.use_strict_mode = 1
session.cookie_samesite = "Strict"
session.name = "PHPSESSID_3DDC"
session.gc_maxlifetime = 1800
session.gc_probability = 1
session.gc_divisor = 100

; File Upload Security
file_uploads = On
upload_max_filesize = 10M
max_file_uploads = 5
upload_tmp_dir = /tmp/php_uploads

; Resource Limits
max_execution_time = 30
max_input_time = 30
memory_limit = 128M
post_max_size = 10M
max_input_vars = 1000

; Disable dangerous functions
disable_functions = exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,show_source,eval,assert

; Hide PHP version
expose_php = Off

; Prevent information disclosure
log_errors_max_len = 1024
ignore_repeated_errors = On
ignore_repeated_source = On

; SQL injection protection (when using PDO)
pdo_mysql.default_socket = /var/run/mysqld/mysqld.sock

; Additional security headers (handled by web server, but backup)
; These should be set by Apache/Nginx, but included as fallback